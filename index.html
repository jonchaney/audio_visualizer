<!doctype html>
<html>

<head>
  <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./lib/bundle.css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <script src="./lib/bundle.js"></script>
  <title>Audio Visualizer</title>
</head>

<body>
  <script>
    // plays all sounds at the same time
    function play(soundObj) {
      let sound = document.getElementById(soundObj);
      let playPromise = sound.play();

      sound.addEventListener('loadeddata', function () {
          playPromise = sound.play();
          console.log(playPromise);
        });
    }
    // stops all sounds
    function pause(soundObj) {
      let sound = document.getElementById(soundObj);
      sound.pause();
      sound.currentTime = 0;
      window.cancelAnimationFrame(window.drawPulse);
      window.cancelAnimationFrame(window.drawWave);
      window.cancelAnimationFrame(window.drawBar);
    }
    // mutes a track
    function mute(soundObj) {
      let sound = document.getElementById(soundObj);
      if (sound.muted) {
        sound.muted = false;
      } else {
        sound.muted = true;
      }
    }
</script>
    <div class="main">
      <section class="info">
        <h1><a href="index.html">Audio Visualizer</a></h1>
        <article>
          <ol>
            <li>press play to visualize three different tracks from the same song</li>
            <li>the first visualization is the vocals</li>
            <li>the second visualization is the guitar</li>
            <li>the third visualization is a combination of the other two tracks with reverb and echo effects</li>
            <li></li>
            <li>--- song: 'shining bright' written by me ---</li>
          </ol>
          <div>
            <a href="https://github.com/jonchaney/audio_visualizer#audio-visualizer">github</a>
          </div>
        </article>
      </section> 

      <div class="buttons">
        <input id="play-button" 
              type="button" 
              value="play"
              onClick="play('bar-audio'),play('wave-audio'),play('pulse-audio')">
        <input type="button" 
              value="stop"
              onClick="pause('bar-audio'),pause('wave-audio'),pause('pulse-audio')">
      </div>
  </div>

  <div class="sounds">

     <div class="sound-bar"> 
      <canvas id="bar-canvas"></canvas>
      <audio id="bar-audio" type="audio/mp3"></audio>
    </div> 
      <input type="button" value="toggle mute" onClick="mute('bar-audio')">

    <div class="sound-pulse">
      <canvas id="pulse-canvas"></canvas>
      <audio id="pulse-audio" type="audio/mp3"></audio>
    </div>
      <input type="button" value="toggle mute" onClick="mute('pulse-audio')">


    <div class="waveform">
      <canvas id="wave-canvas"></canvas>
      <audio id="wave-audio" type="audio/mp3"></audio>
    </div>
      <input type="button" value="toggle mute" onClick="mute('wave-audio')">
  </div>

</body>

</html>